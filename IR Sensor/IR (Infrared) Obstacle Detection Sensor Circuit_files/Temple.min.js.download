

var __extends=this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}__.prototype=b.prototype;d.prototype=new __();};
window.$ = window.jQuery || function(e,t,l){var n={"#":"getElementById",".":"getElementsByClassName","@":"getElementsByName","=":"getElementsByTagName","*":"querySelectorAll"}[e[0]],m=(t===l?document:t)[n](e.slice(1));return m.length<2?m[0]:m};
Element.prototype.hide=function(){if(this.classList)this.classList.add('hide');};Element.prototype.show=function(){if(this.classList)this.classList.remove('hide');}
String.prototype.timeFormat=function(){var sn=parseInt(this,10);var h=Math.floor(sn/3600);var m=Math.floor((sn-(h*3600))/60);var s=sn-(h*3600)-(m*60);if(m<10){m=m;};if(s<10){s="0"+s;};var t=(m||0)+':'+(s||"00");return t;}
String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.slice(1);}
Function.prototype.delay=function(a){var b=[].slice.call(arguments,1),c=this;return setTimeout(function(){c.apply(void 0,b)},1e3*a)};
Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var o=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r?this:t,o.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(r.prototype=this.prototype),i.prototype=new r,i});
"function"!=typeof Object.assign&&!function(){Object.assign=function(n){"use strict";if(void 0===n||null===n)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(n),r=1;r<arguments.length;r++){var e=arguments[r];if(void 0!==e&&null!==e)for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])}return t}}();
if("document"in self){if(!("classList"in document.createElement("_"))||document.createElementNS&&!("classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))){(function(t){"use strict";if(!("Element"in t))return;var e="classList",i="prototype",n=t.Element[i],s=Object,r=String[i].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[i].indexOf||function(t){var e=0,i=this.length;for(;e<i;e++){if(e in this&&this[e]===t){return e}}return-1},o=function(t,e){this.name=t;this.code=DOMException[t];this.message=e},l=function(t,e){if(e===""){throw new o("SYNTAX_ERR","An invalid or illegal string was specified")}if(/\s/.test(e)){throw new o("INVALID_CHARACTER_ERR","String contains an invalid character")}return a.call(t,e)},c=function(t){var e=r.call(t.getAttribute("class")||""),i=e?e.split(/\s+/):[],n=0,s=i.length;for(;n<s;n++){this.push(i[n])}this._updateClassName=function(){t.setAttribute("class",this.toString())}},u=c[i]=[],f=function(){return new c(this)};o[i]=Error[i];u.item=function(t){return this[t]||null};u.contains=function(t){t+="";return l(this,t)!==-1};u.add=function(){var t=arguments,e=0,i=t.length,n,s=false;do{n=t[e]+"";if(l(this,n)===-1){this.push(n);s=true}}while(++e<i);if(s){this._updateClassName()}};u.remove=function(){var t=arguments,e=0,i=t.length,n,s=false,r;do{n=t[e]+"";r=l(this,n);while(r!==-1){this.splice(r,1);s=true;r=l(this,n)}}while(++e<i);if(s){this._updateClassName()}};u.toggle=function(t,e){t+="";var i=this.contains(t),n=i?e!==true&&"remove":e!==false&&"add";if(n){this[n](t)}if(e===true||e===false){return e}else{return!i}};u.toString=function(){return this.join(" ")};if(s.defineProperty){var h={get:f,enumerable:true,configurable:true};try{s.defineProperty(n,e,h)}catch(d){if(d.number===-2146823252){h.enumerable=false;s.defineProperty(n,e,h)}}}else if(s[i].__defineGetter__){n.__defineGetter__(e,f)}})(self)}else{(function(){"use strict";var t=document.createElement("_");t.classList.add("c1","c2");if(!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var i,n=arguments.length;for(i=0;i<n;i++){t=arguments[i];e.call(this,t)}}};e("add");e("remove")}t.classList.toggle("c3",false);if(t.classList.contains("c3")){var i=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){if(1 in arguments&&!this.contains(t)===!e){return e}else{return i.call(this,t)}}}t=null})()}}
function shuffle(o){for(var j, x, i = o.length; i; j = Math.floor(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);return o;}


var temple = temple || new Temple();

function Temple () {
	this.version = 'v1.1';
	this.type = 'core';
	this.defaultExitURL = "";
	this.exitURLs = [""];
	this.isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
	this.isiOS = /iPad|iPhone|iPod/.test( navigator.userAgent );
	this.isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
	
	this.isLive = function() {
		if (!this.config) return window.location.hostname != 'localhost';
		if (!this.config.localhost) return window.location.hostname != 'localhost';
		var live = window.location.hostname != 'localhost';
		
		for (var i = 0; i < this.config.localhost.length; i++) {
			if (window.location.hostname == this.config.localhost[i]) {
				live = false;
				break;
			}
		}

		return live;
	}();

	this.color = '#ff0088';
	this.config = {};
	this.core = {};
	this.platforms = {};
	this.templates = {};
	this.modules = {};
	
	this.tracker = function(t) {
		temple.utils.debug('Tracker: ' + t,'green');
	};

	this.utils = (function() {
		var getQueryVar = function(v){ 
			var q = window.location.search.substring(1);
			var vs = q.split('&');
			for (var i=0;i<vs.length;i++) {
				var p = vs[i].split('=');
				if (p[0] == v) {
					return p[1];
				}
			}
			return(false);
		}
		
		var loadScript = function(u,c,e){
			if(typeof(u)=='string')u = [u];var t=0;
			for(var i=0;i<u.length;i++){var s=document.createElement('script');s.async=true;s.type='text/javascript',s.readyState?s.onreadystatechange=function(){('loaded'==s.readyState||'complete'==s.readyState)&&(s.onreadystatechange=null,c&&c())}:(s.onload=function(e){t++;if(t==u.length)c&&c(e)},s.onerror=function(){temple.utils.debug('ERROR LOADING SCRIPT "' + u + '"'),e&&e()}),s.src=u[i],document.body.appendChild(s);}
		}
		
		var loadJSON = function(u, c, e, nt) {
			if(typeof(u)=='string')u = [u];var t=0;
			var comp = c; var obs=[];
			c = function(o){t++;obs.push(o);if(t==u.length){if(obs.length==1)obs=obs[0];comp(obs);}};var xobj = [];
			for(var i=0;i<u.length;i++) {
				xobj[i] = new XMLHttpRequest;
				xobj[i].overrideMimeType('application/json');
				xobj[i].open('GET',u[i],!0);
				xobj[i].onreadystatechange = function(e) {x=e.currentTarget;
					4==x.readyState&&'404'==x.status&&(temple.utils.debug('No json found','#ff0000'),e&&e()),4==x.readyState&&'200'==x.status&&c&&c(nt===true ? x.responseText : JSON.parse(x.responseText))},xobj[i].send(null);
			}
		}
		
		var loadImage = function(u, c, e) {
			var i = new Image();
			i.onload = function(e) {
				c(this,e)
			};
			i.onerror = e;
			i.src = u;
		}
		
		var createStyle = function(n,r){
			n=(n!='banner'?'#banner '+n:n);
			if(!temple.stylesheet){
				temple.stylesheet=document.createElement('style'),temple.stylesheet.type='text/css';
				var head=document.getElementsByTagName('head')[0];
				head.insertBefore(temple.stylesheet,head.firstChild)
			}
			(temple.stylesheet.sheet||{}).insertRule?temple.stylesheet.sheet.insertRule(n+'{'+r+'}',0):(temple.stylesheet.styleSheet||temple.stylesheet.sheet).addRule(n,r);
		}
		
		var debug = function(e,c,v) {
			if (console.debug && (!temple.isLive || temple.config.debug === true)) {
				console.debug(
					'%c[' + temple.type + ']%s',
					'font-weight:bold;color:' + (typeof c == 'string' ? c : temple.color) + ';',
					' ' + (v || temple.version),
					':',
					e || '',
					typeof c != 'string' && typeof c != 'undefined' ? c : ''
				);	
			}
		}
		
		return {
			getQueryVar: 	function(v){ return getQueryVar(v); },
			loadScript: 	function(u,c,e){ loadScript(u,c,e); },
			loadJSON: 		function(u,c,e,nt){ loadJSON(u,c,e,nt); },
			loadImage: 		function(u,c,e){ loadImage(u,c,e); },
			debug: 			function(e,c,v){ debug(e,c,v); },
			createStyle: 	function(n,r){ createStyle(n,r); }
		}
	})();

	this.events = {
		READY: 			'ready',
		SHOW: 			'show',
		CORE_READY: 	'core_ready',
		MODULE_READY: 	'module_ready',
		EXIT: 			'exit'
	}	
}

temple.core.EventDispatcher = ( function() {	

	function EventDispatcher() {}

	EventDispatcher.prototype.dispatchEvent = function(event, args) {
		if (!arguments[1]) arguments[1] = this;

		this._events = this._events||[];

		if ( this._events[event] ) {
			var listeners = this._events[event], len = listeners.length;
			while ( len-- ) {
				temple.utils.debug('Event <' + event + '> ' + (arguments[1].target ? arguments[1].target.constructor.name:arguments[1].constructor.name), 'black');
				if (!args) args = {};
				if (!args.target) args.target = this;
				if (!listeners[len]._one) {
					var f = listeners.splice(len, 1);
					f[0](args);
				} else {
					listeners[len](args);					
				}
			}	
			return true;	
		}
		return false;	
	}

	EventDispatcher.prototype.addEventListener = function(event, callback, _one) {
		callback._one = _one != undefined ? _one : true;
		this._events=this._events || [];
		this._events[event] = this._events[event] || [];
		if ( this._events[event] ) {
			this._events[event].push(callback);
		}
	}

	EventDispatcher.prototype.removeEventListener = function(event) {
		if ( this._events[event] ) {
			delete this._events[event];
		}
	}	
	
	EventDispatcher.prototype.moduleReady = function() {
		temple.utils.debug('Module <' + this.constructor.name + '>', this.color || 'Tomato');
		this.dispatchEvent(temple.events.READY);			
	}
	
	EventDispatcher.prototype.isReady = function() {
		setTimeout(this.moduleReady.bind(this), 50);
	}
	
	return EventDispatcher;
})();
temple.core.Core = ( function(_super) {
	__extends(Core, _super);

	function Core() {
		this._version = '1.0';
		temple.type = 'Standalone';
		this.initCore();
	}
	
	Core.prototype.initCore = function() {
		temple.utils.debug(temple.type + ' Platform');
		window.addEventListener('load', this.pageReady.bind(this));
	}

	Object.defineProperty(Core.prototype, 'width', {
        get: function () {
            return this.banner.getBoundingClientRect().width;
        },
        enumerable: true,
        configurable: true
    });

	Object.defineProperty(Core.prototype, 'height', {
        get: function () {
            return this.banner.getBoundingClientRect().height;
        },
        enumerable: true,
        configurable: true
    });
	
	Core.prototype.pageReady = function() {
		this.loadConfig();
	}
	
	Core.prototype.loadConfig = function() {
		var configtype = 'json';
		var config = window.config || document.body.getAttribute('data-config') || 'config.json';
		if (config) {
			if (config.split('.')[1] == 'js'){
				configtype = '.js';
			}
			else{
				configtype = '.json';
			}
		}
		config = config.replace(configtype,'');
		if (document.querySelector('body').classList.contains('snapshot')) {
			if (window.snapshot_language) {
				config = config + '_' + window.snapshot_language + configtype;
			} else {
				config = config + configtype;
			}
		} else {
			config = temple.utils.getQueryVar('ln') ? config + '_' + temple.utils.getQueryVar('ln') + configtype : config + configtype;			
		}		
	    temple.utils.loadJSON(config, function(json) {
			this.config = temple.config = json;
			if (this.config.modules.length) {
				this.loadModule();
			} else {
				this.bannerInit();
			}
	    }.bind(this), this.bannerInit.bind(this));
	}

	Core.prototype.loadModule = function() {
		if (this.modulesLoaded == this.config.modules.length) {
			this.bannerInit();
			return;
		}
		this.modulesLoaded = this.modulesLoaded || 0;
		var m = this.config.modules[this.modulesLoaded];
		if (m.indexOf('.js') == -1) m = '../scripts/temple/modules/' + m + '.js';
		temple.utils.loadScript(m, function() {
			this.modulesLoaded++; this.loadModule();
		}.bind(this), function(){temple.utils.debug('Module does not exist', 'red')});
	}
	
	Core.prototype.exit = function(type, url) {
		switch(type){
			default:
				window.open(url||this.defaultExitURL||this.exitURLs[0], '_blank');
		}
		this.dispatchEvent(temple.events.EXIT);
	}
	
	Core.prototype.bannerInit = function() {
	    temple.utils.createStyle('#banner', 'position:relative;overflow:hidden;background-color:#000;color:#fff;width:'
	    	+ (temple.config.size.width ? temple.config.size.width + 'px;height:' : 'auto;height:')
	    	+ (temple.config.size.height ? temple.config.size.height + 'px;' : 'auto;'));
	    temple.utils.createStyle('.bannerClick', 'position:absolute;top:0;left:0;width:100%;height:100%;cursor:pointer;background:url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7);');

		this.dispatchEvent(temple.events.CORE_READY);
	}

	Core.prototype.chainLoaded = function(e) {
		this.chained.splice(0, 1);
		this.runChain();
	}
	
	Core.prototype.runChain = function(e) {
		if (!this.chained[0]) {
			return;
		}
		if (this.chained[0].m.prototype.__proto__.constructor != temple.core.EventDispatcher) {
			this.chained[0].m.call(this);
			this.chainLoaded();			
			return;
		}
		var m = new this.chained[0].m(this.chained[0].a||this);
		m.addEventListener(temple.events.READY, this.chainLoaded.bind(this));
		var name = this.chained[0].m.name || this.chained[0].m.toString().match(/^function\s*([^\s(]+)/)[1];
		var moduleName = name.toLowerCase().replace('module', 'Module').replace('controller', 'Controller').replace('dcvideo', 'video');
		if (this[moduleName]) {
			this[moduleName+'List'] = this[moduleName+'List'] || [this[moduleName]];
			this[moduleName+'List'].push(m);
			var t = 2;
			var tempName = moduleName;
			tempName = moduleName + t;
			while(this[tempName]) {
				t++;
				tempName = moduleName + t;
			}
			moduleName = tempName;
		}
		this[moduleName] = m;
	}

	Core.prototype.chain = function(e) {
		if (!this.chained) {
			this.chained = [];
			this.chained.push({m:e, a:arguments[1]});
			setTimeout(this.runChain.bind(this), 1);
		} else {
			this.chained.push({m:e, a:arguments[1]});			
		}

		return this;
	}
	
	Core.prototype.politeLoads = function(c) {
        var l = document.querySelectorAll('[polite]');
        var s = document.querySelectorAll('[svg]');
        var t = 0;
        var t2 = 0;
		function onload(e) {
            if (l[t].nodeName == 'DIV')
                l[t].style.backgroundImage = "url('" + l[t].getAttribute('data-src') + "')";
            t++;
            if (t+t2==l.length+s.length) if (c) c();
        }
        for (var i = 0; i < l.length; i++) {
            if (l[i].nodeName == 'DIV') {
                var img = new Image();
                img.onload = onload.bind(this);
                img.src = l[i].getAttribute('data-src');
            } else {
                l[i].onload = onload.bind(this);
                l[i].src = l[i].getAttribute('data-src');
            }
        }

        var svgs = [];
        for (i = 0; i < s.length; i++) {
        	svgs[i] = {xhr:new XMLHttpRequest(), el:s[i]};
        	svgs[i].xhr.id = i;
        	svgs[i].xhr.onload = function(e) {
        		var r = e.currentTarget.responseXML.documentElement;
        		r.setAttribute('class', svgs[e.currentTarget.id].el.getAttribute('class'));
				var id = svgs[e.currentTarget.id].el.getAttribute('id');
        		r.setAttribute('id', id);
        		svgs[e.currentTarget.id].el.parentNode.replaceChild(r, svgs[e.currentTarget.id].el);
        		window[id] = r;
            	t2++;
            	if (t+t2==l.length+s.length) if (c) c();
        	};
        	svgs[i].xhr.open('GET', s[i].getAttribute('data-src'), !0);
        	svgs[i].xhr.overrideMimeType("image/svg+xml");
			svgs[i].xhr.send("");
        }
        if (!l.length && !s.length) c();
	
	}

	Core.prototype.setLanguage = function(c) {
        var l = document.querySelectorAll('[multilingual]');
        var t = 0;
        function onload() {
            if (l[t].nodeName == 'DIV')
                l[t].style.backgroundImage = "url('" + 'img/' + this.config.language + '/' + l[t].getAttribute('data-src') + "')";
            t++;
            if (t==l.length) if (c) c();
        }
        for (var i = 0; i < l.length; i++) {
            if (l[i].nodeName == 'DIV') {
                var img = new Image();
                img.onload = onload.bind(this);
                img.src = 'img/' + this.config.language + '/' + l[i].getAttribute('data-src');
            } else {
                l[i].onload = onload.bind(this);
                l[i].src = 'img/' + this.config.language + '/' + l[i].getAttribute('data-src');
            }
        }
        if (!l.length) c();
    }
	return Core;
})( temple.core.EventDispatcher );


temple.platforms.dc = {};
temple.platforms.dc.Platform = ( function(_super){ 
	
	__extends(Platform, _super);
	
	function Platform() {
		temple.color = "#338e43";
		temple.type = "DoubleClick";
		this.defaultExitURL = "";
		this.exitURLs = [""];
		temple.tracker = this.tracker;
		this._platform = {
			_closeOverlay: function() {
				Enabler.close();
			}
		};

		this.initCore();
	}
	
	Platform.prototype.pageReady = function() {
		temple.isLive = Enabler.isServingInLiveEnvironment();
		if (typeof(Enabler)!="undefined") {
		    if (Enabler.isInitialized()) this.pageLoaded();
		    else Enabler.addEventListener(studio.events.StudioEvent.INIT, this.pageLoaded.bind(this));
		} else {
		    setTimeout(this.init.bind(this), 50);
		}
	}
	
	Platform.prototype.pageLoaded = function() {
		if (Enabler.isPageLoaded()) this.loadConfig();
    	else Enabler.addEventListener(studio.events.StudioEvent.PAGE_LOADED, this.loadConfig.bind(this));
    	Enabler.addEventListener(studio.events.StudioEvent.EXIT, this.onExit.bind(this));
	}

	Platform.prototype.tracker = function(title, repeat) {
		if (repeat == undefined) repeat = true;
		this._trackedEvents = this._trackedEvents || [];
		if (this._trackedEvents.length > 19) return;
		if (repeat === false && this._trackedEvents.indexOf(title) >= 0) return;
		if (this._trackedEvents.indexOf(title) == -1) {
			this._trackedEvents.push(title);
		}
		Enabler.counter(title, repeat);
		temple.utils.debug('Tracked Event: ' + (this._trackedEvents.indexOf(title) + 1) + ' - ' + title, 'green');
	}
	
	Platform.prototype.onExit = function() {
		
	}
	
	
	Platform.prototype.exit = function(type, url) {
		switch(type) {
			default:
				Enabler.exitOverride('Default Exit', url||this.defaultExitURL||this.exitURLs[0]);
				this.dispatchEvent(temple.events.EXIT, {url:url||this.defaultExitURL||this.exitURLs[0]});
		}

	}

	Platform.prototype.bannerInit = function() {	
		_super.prototype.bannerInit(this);		
	}

	return Platform;

})( temple.core.Core );

temple.platforms.Platform = temple.platforms.dc.Platform;


temple.templates.StandardBanner = ( function( _super ) {
    __extends(StandardBanner, _super);
    
    function StandardBanner() {
        _super.call(this, arguments[0]);
        temple.utils.debug('Template <'+arguments.callee.name+'>');
    }

    StandardBanner.prototype.show = function(autoplay) {
        if (this.config.video) if(this.config.video.autoplay && !autoplay) {
            this.dispatchEvent(temple.events.VideoEvents.AUTOPLAY);
            this.videoController.getSource(0).addEventListener(temple.events.VideoEvents.COMPLETE, this.startAnimation.bind(this), false);
            this.videoController.getSource(0).addEventListener(temple.events.VideoEvents.CLOSE, this.startAnimation.bind(this), false);
            return;
        }
        if (document.body.classList.contains('phantom-backup')) {
            this.onBackupImage();
        }

        this.banner.classList.remove('hide');

        if (this.config.video) if (!this.config.video.autoplay) this.startAnimation();
        if (!this.config.video) this.startAnimation();

        this.dispatchEvent(temple.events.SHOW);
        
        if (document.body.classList.contains('phantom-backup')) {
            alert('{"phantom":"phantom-backup"}');
        }

        if (this.config.ytmh) {
            temple.utils.createStyle("#ytClose", "z-index: 20;");

            if (this.config.ytmh.impression.length) {
                this.Impression_Pixel_URL = this.Impression_Pixel_URL || this.config.ytmh.impression;
            }
            
            if (this.config.ytmh.retargeting.length) {
                this.Click_Pixel_URL = this.Click_Pixel_URL || this.config.ytmh.retargeting;
            }

            if (this.Impression_Pixel_URL.length) {
                temple.utils.debug("Impression Pixel tracked | " + this.Impression_Pixel_URL, "blue");
                temple.utils.loadImage(this.Impression_Pixel_URL);
            }

            if (this.Click_Pixel_URL.length) {
                this.addEventListener(temple.events.EXIT, function() {
                    temple.utils.debug("Retargeting Pixel tracked | " + this.Click_Pixel_URL, "blue");
                    temple.utils.loadImage(this.Click_Pixel_URL);
                }.bind(this));
            }
        }
    }    

    StandardBanner.prototype.showEndScreen = function() {
        this.animations[0].stop();
        this.createjsModule.removeChild(this.animations[0]);
        this.currentAnimation = this.animations.length;
        var i = this.animations.length - 1;
        this.createjsModule.addChild(this.animations[i]);
        var f = this.animations[i].totalFrames;
        this.animations[i].gotoAndStop(f-1);
    }
    
    StandardBanner.prototype.onBannerClick = function() {
        this.exit();
    }

    StandardBanner.prototype.startAnimation = function() { }
    StandardBanner.prototype.onTabChange = function() { }
    StandardBanner.prototype.onBackupImage = function() { }
    StandardBanner.prototype.onExit = function() { }
    StandardBanner.prototype.onOver = function(e) { }
    StandardBanner.prototype.onOut = function(e) { }
    StandardBanner.prototype.init = function(e) { }
    

    // private

    StandardBanner.prototype.bannerInit = function() {
        _super.prototype.bannerInit(this);
        this.ready();
    }
    
    StandardBanner.prototype.ready = function() {
        this.banner                 = document.getElementById("banner");
        this.bannerClick            = document.querySelectorAll(".bannerClick");

        if (document.body.classList.contains('phantom-backup')) {
            this.isBackup = true;
        }

        for (i=0; i < this.bannerClick.length; i++) {
            this.bannerClick[i].addEventListener("click", this.onBannerClick.bind(this));
            this.bannerClick[i].addEventListener("mouseover", this.onOver.bind(this));
            this.bannerClick[i].addEventListener("mouseleave", this.onOut.bind(this));            
        }

        this._addTabEvents();

        if (this._addExitEvents) this._addExitEvents();
        else this.addEventListener(temple.events.EXIT, this.onExit.bind(this));
        
        this.politeLoads( function() {
            if (navigator.userAgent.toLowerCase().indexOf('firefox') > -1 && !window.innerHeight) {
                window.onresize = function() {
                    if (!temple.isVisible) {
                        temple.isVisible = true;
                        window.onresize = null;
                        this.dispatchEvent(temple.events.READY);
                        this.init();
                    }
                }.bind(this)
                
                if (!temple.isVisible) return;          
            }
            this.dispatchEvent(temple.events.READY);
            this.init();
        }.bind(this));
    }    
    
    StandardBanner.prototype._addTabEvents = function() {
        this._isHidden = false;
        if ("hidden" in document) {
            document.addEventListener("visibilitychange", this.onTabChange.bind(this));
        } else if ((this._isHidden = "mozHidden") in document) {
            document.addEventListener("mozvisibilitychange", this.onTabChange.bind(this));
        } else if ((this._isHidden = "webkitHidden") in document) {
            document.addEventListener("webkitvisibilitychange", this.onTabChange.bind(this));
        } else if ((this._isHidden = "msHidden") in document) {
            document.addEventListener("msvisibilitychange", this.onTabChange.bind(this));
        } else if ("onfocusin" in document) {
            document.onfocusin = document.onfocusout = this.onTabChange.bind(this);
        } else {
            window.onpageshow = window.onpagehide = window.onfocus = window.onblur = this.onTabChange.bind(this);
        }
    }
    
    return StandardBanner;

})( temple.platforms.Platform || temple.core.Core );

temple.Template = temple.templates.StandardBanner;

var banner = new temple.Template();

banner.init = function() {
    this.setupDynamic();
};

banner.setupDynamic = function() {
    this.animationSources = [ "js/336x280_intro.js" ];
    this.animationLibs = [ "lib_336x280_intro" ];
    this.animationSprites = [ "img/336x280_intro_atlas_.png" ];
    for (var i = 0; i < this.config.animation.length; i++) {
        this.animationSources.push(this.config.animation[i].js);
        this.animationLibs.push("lib_" + this.config.animation[i].id);
        this.animationSprites.push(this.config.animation[i].spritesheet);
    }
    this.animationSources.push("js/336x280_outro.js");
    this.animationLibs.push("lib_336x280_outro");
    this.animationSprites.push("img/336x280_outro_atlas_.png");
    this.chain(temple.CreateJSModule, {
        canvas: "canvas_module",
        size: {
            width: 336,
            height: 280
        },
        src: this.animationSources,
        lib: this.animationLibs,
        spriteimage: this.animationSprites
    }).chain(this.setupCreateJs).chain(this.show);
    banner.endframeId = this.animationSprites.length - 1;
};

banner.setupCreateJs = function() {
    this.animations = [];
    this.createjsModule.lib.forEach(function() {
        var a = arguments;
        this.animations[a[1]] = new a[0]._root();
        this.animations[a[1]].addEventListener("ended", this.onAnimationEnded.bind(this));
        this.animations[a[1]].addEventListener("next", this.onNextAnimation.bind(this));
    }.bind(this));
    this.currentAnimation = 0;
    this.createjsModule.addChild(this.animations[this.currentAnimation]);
};

banner.startAnimation = function() {
    this.createjsModule.start();
};

banner.onBannerClick = function() {
    this.exit("default", window.clickTag);
    banner.toEndframe();
};

banner.onAnimationEnded = function(e) {
    if (this.currentAnimation < this.createjsModule.lib.length) this.createjsModule.removeChild(e.target);
};

banner.onNextAnimation = function() {
    if (this.currentAnimation < this.createjsModule.lib.length) {
        this.currentAnimation++;
        this.createjsModule.addChild(this.animations[this.currentAnimation]);
    }
};

banner.toEndframe = function() {
    this.currentAnimation = banner.endframeId;
    this.createjsModule.addChild(this.animations[this.currentAnimation]);
};

function DC_counters() {}